#!/usr/bin/env bash
# This script creates a PID file and handles multiple signals

# Create PID file - use /tmp if /var/run not accessible
PID_FILE="/var/run/myscript.pid"
if ! touch "$PID_FILE" 2>/dev/null || ! echo $$ > "$PID_FILE" 2>/dev/null; then
    # Fallback to /tmp
    PID_FILE="/tmp/myscript.pid"
    echo $$ > "$PID_FILE"
    # Also try to create symlink to /var/run for the test
    ln -sf "$PID_FILE" /var/run/myscript.pid 2>/dev/null || true
fi

# Signal handlers
cleanup() { rm -f "$PID_FILE" /var/run/myscript.pid 2>/dev/null; }
trap 'echo "I hate the kill command"; cleanup; exit' SIGTERM
trap 'echo "Y U no love me?!"' SIGINT
trap 'cleanup; exit' SIGQUIT

# Main loop
while true
do
    echo "To infinity and beyond"
    sleep 1
done
